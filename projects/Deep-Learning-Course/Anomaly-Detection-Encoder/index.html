<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Amin Fadaeinejad | Anomaly Detection using Auto encoder</title>
  <meta name="description" content="This is the personal website of Otilia Stretcu">

  <!-- Fonts and Icons -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons" />

  <!-- CSS Files -->
  <link rel="stylesheet" href="/assets/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/academicons.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="canonical" href="/projects/2_livex/">


<style>
table, th, td {
  border: 1px solid black;
}
</style>

</head>
<body>
  <!-- Header -->
  <nav id="navbar" class="navbar fixed-top navbar-expand-md grey lighten-5 z-depth-1 navbar-light">
    <div class="container-fluid p-0">
      
        <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Amin</span> Fadaeinejad</a>
      
      <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
            
          
            
              <li class="nav-item ">
                  <a class="nav-link" href="/cv/">
                    Curriculum Vitae
                    
                  </a>
              </li>
            
          
            
          
            
              <li class="nav-item ">
                  <a class="nav-link" href="/projects/">
                    Projects
                    
                  </a>
              </li>
            
          
            
              <li class="nav-item ">
                  <a class="nav-link" href="/publications/">
                    Publications
                    
                  </a>
              </li>
            
          
          
              <li class="nav-item ">
                  <a class="nav-link" href="/teaching/">
                    Teaching
                  </a>
              </li>
            
          
            
          
        </ul>
      </div>
    </div>
  </nav>

  <!-- Scrolling Progress Bar -->
  <progress id="progress" value="0">
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>
  </progress>

  <!-- Content -->
  <div class="content">
    
  <h1>Anomaly Detection</h1>
  <h6>Desigining an auto-encoder for anomaly detection in the MVTec dataset.</h6>


<p><br /></p>

<p> In data science, anamaly detection is when the system tries to detect a rare item, event or observation which deviate significantly from the original distribution and can not be defined as a normal behaviour. Three different categories of anomaly detection exists</p>

<ul>
  <li>Supervised anomaly detection</li>
  <li>Semi-supervised anomaly detection</li>
  <li>Unsupervised anomaly detection</li>
</ul>

<p><br /></p>

<p> In data science, anamaly detection is when the system tries to detect a rare item, event or observation which deviate significantly from the original distribution and can not be defined as a normal behaviour. Three different categories of anomaly detection exists</p>

<h2 id="overview">1. Background</h2>

<h3 id="overview">1.1  Anomaly Detection</h3>

<p>Anomaly detection is also known as out-layer analysis is a step-in data mining that identifies data points, events, and observations that deviate from a data set’s normal behaviour. Anomalies our out-layers are data points within the data sets that appear to deviate markedly from expected outputs. It is the process of finding patterns in data that do not conform to prior expected behaviour. Anomaly detection is being employed more increasingly in the presence of big data that is captured by sensors, social media platforms, huge networks, etc. They also have many applications including energy systems, medical devices, banking network intrusion detection, etc. Machine learning is progressively being used to automate anomaly detection. </p>


<h3 id="overview"> 1.2. Auto-Encoders</h3>

<p>Auto Encoder is a generative unsupervised deep learning
algorithm used for reconstructing high-dimensional input
data using a neural network with a narrow bottleneck layer in
the middle that contains the latent representation of the input
data. Auto-Encoders have two main parts called, Encoder
and Decoder. </p>

<ul>
  <li>Encoder: Accepts high-dimensional input data and translates it to latent low-dimensional data. The input size to an Encoder network is larger than its output size </li>
  <li>Decoder: The Decoder network receives the input from the Encoder coder’s output. The decoder’s objective is to reconstruct the input data. The output size of a Decoder network is larger than its input size</li>
</ul>

<h3 id="overview">1.3 Accuracy methods </h3>

<p>In order to be able to compare our result with the results that
are already published be need to have a standard accuracy
method. First off we need to know the concept of True and
Predicted conditions. Two types of correct predictions (True
Positives and True Negatives), and there are two types of
errors. Error Type I for any observation predicted positive
when actually it is negative (False Positive, also called False
Alert). Error Type II for any observation predicted negative
when actually it is positive (False Negative).
 </p>


<h2 id="overview">1. Background</h2>

<td><img src="/assets/img/True Positive.ppm" alt="iqubes" width="400px" height="200px" /></td>


<h2 id="overview"> Dataset</h2>

<p>For our project, we used the MVTec data-set that belonged
to <a href="https://www.semanticscholar.org/paper/The-MVTec-Anomaly-Detection-Dataset%3A-A-Real-World-Bergmann-Batzner/48f9a48aa5b1230b05a443d2d531e6441a541686">Paul Bergmann, January
2021</a>, this data set contained
several different groups of images such as Bottles, Cables, Capsule, Carpet, Grid, Hazelnut, Leather, Metal Nut,
Pill, Screw, Tile, Toothbrush, Transistor, Wood and Zipper.
Which for our project due to the limitation we were able to
only train one of the data sets. We used the Hazelnut dataset which contained 390 defect-free images. Deep neural
networks are known for their impressive accuracy when they
are trained with a very large data set, therefore we used data
augmentation to increase the number of data samples that
we have. We used methods suck as rotation, flipping and
adding noise to increase the number of data samples. In the
end, we had approximately 2000 images. There are 70 test
images which different types such as crack, cut, hole and
print. The data-set also includes ground Truth to calculate
the accuracy of the testing.</p>





<h2 id="more-information"> Discussions</h2>

<h3 id="more-information">  Effect of Threshold</h3>


<p>In the last part we are going to compare our result with other
methods and approaches that are out there.
</p>

<h3 id="more-information"> Effect of Latent Space size</h3>


<p>In the last part we are going to compare our result with other
methods and approaches that are out there.
</p>




<h3 id="more-information">  Effect of Threshold</h3>


<h2 id="more-information"> Conclusions</h2>


<p>In the last part we are going to compare our result with other
methods and approaches that are out there.
</p>

<table style="width:100%">
  <tr>
    <td>METHODS</td>
    <td>RECALL</td>
    <td>PRECISION</td>
    <td>F1</td>
  </tr>
  <tr>
    <td>OUR METHOD (PRINT)</td>
    <td>0.22</td>
    <td>0.82</td>
    <td>0.35</td>
  </tr>
  <tr>
    <td>OUR METHOD (CRACK)</td>
    <td>0.26</td>
    <td>0.57</td>
    <td>0.36</td>
  </tr>
  <tr>
    <td>OUR METHOD (CUT)</td>
    <td>0.69</td>
    <td>0.8</td>
    <td>0.57</td>
  </tr>
  <tr>
    <td>OUR METHOD (HOLE)</td>
    <td>0.55</td>
    <td>0.61</td>
    <td>0.75</td>
  </tr>
  <tr>
    <td>AE(SSIM)</td>
    <td>0.08</td>
    <td><strong>1</strong></td>
    <td>0.15</td>
  </tr>
  <tr>
    <td><strong>AE(L2)</strong></td>
    <td>0.84</td>
    <td>0.93</td>
    <td><strong>0.88</strong></td>
  </tr>
  <tr>
    <td>ANOGAN</td>
    <td>0.16</td>
    <td>0.83</td>
    <td>0.27</td>
  </tr>
  <tr>
    <td>CNN FEATURE DICTIONARY</td>
    <td>0.07</td>
    <td>0.9</td>
    <td>0.13</td>
  </tr>
  
</table>


<p>We compared our approach with some of the models that
are already used and it seems <a href="https://www.semanticscholar.org/paper/The-MVTec-Anomaly-Detection-Dataset%3A-A-Real-World-Bergmann-Batzner/48f9a48aa5b1230b05a443d2d531e6441a541686">Paul Bergmann, January
2021</a> has the best performance when they train their model
on a L2 loss function. But it seems that our approach is
good since we outperform other methods such as AnoGANs,
Auto Encoders using SSIM and CNN feature Dictionary.
However, our approach has a lower accuracy in all 3 metrics
(Recall, Precision and F1) compared to the state-of-the-art
method. In one special case, the AE approach with the
SSIM loss function was able to reach 100 % for precision,
however, they were not able to have a good performance of
the Recall, therefor according to our F1 metric, our approach
outperforms the AE(SSIM) approach.
</p>

<h2 id="overview">Project Video</h2>

<p><br /></p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/We84bzNKbOA" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen=""></iframe>

<p><br /></p>

<h2 id="iqube">IQube</h2>

<table>
  <tbody>
    <tr>
      <td>IQubes are electronic smart cubes with an LCD screen on each of its side, with many sensors and capable of communicating with other IQubes and with the cloud. They are mainly used as a hands-on user interface for an experiment. They can be combined in many different ways to perform a large variety of experiments.</td>
      <td><img src="/assets/img/iqubes.jpg" alt="iqubes" width="400px" height="200px" /></td>
    </tr>
  </tbody>
</table>

<p>Demos:</p>
<ul>
  <li><a href="https://www.youtube.com/watch?v=5ECKVCUd-_U">Kindergardern</a></li>
  <li><a href="https://www.youtube.com/watch?v=ZXDn1UkRopU">Math experiment</a></li>
  <li><a href="https://www.youtube.com/watch?v=oRxCezetktQ">Chemistry experiment</a></li>
  <li><a href="https://www.youtube.com/watch?v=_GwqvTuD3vU">Chemistry experiment 2</a></li>
</ul>

<p><br /></p>

<h2 id="smartphone-demos">Smartphone Demos</h2>
<ul>
  <li><a href="https://www.youtube.com/watch?v=vw0UVKfAWHY">Light and centrifugal force experiment</a></li>
  <li><a href="https://www.youtube.com/watch?v=anV1wU7SF5E">Inclined plane experiment</a></li>
</ul>

<p><br /></p>

<h2 id="more-information">More information</h2>

<p>Meet the <a href="https://www.youtube.com/watch?v=3nQ2rQ2Ef7g">team</a>. <br />
Find us on <a href="https://www.facebook.com/LiveXLearningPlatform/">Facebook</a>.</p>


  </div>

  <!-- Footer -->
  <footer>
    &copy; Copyright 2021 Otilia Stretcu.
    
    
  </footer>

  <!-- Core JavaScript Files -->
  <script src="/assets/js/jquery.min.js" type="text/javascript"></script>
  <script src="/assets/js/popper.min.js" type="text/javascript"></script>
  <script src="/assets/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="/assets/js/mdb.min.js" type="text/javascript"></script>
  <script async="" src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js" integrity="sha384-GNFwBvfVxBkLMJpYMOABq3c+d3KnQxudP/mGPkzpZSTYykLBNsZEnG2D9G/X/+7D" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>
  <script src="/assets/js/common.js"></script>

  <!-- Scrolling Progress Bar -->
  <script type="text/javascript">
    $(document).ready(function() {
      var navbarHeight = $('#navbar').outerHeight(true);
      $('body').css({ 'padding-top': navbarHeight });
      $('progress-container').css({ 'padding-top': navbarHeight });
      var progressBar = $('#progress');
      progressBar.css({ 'top': navbarHeight });
      var getMax = function() { return $(document).height() - $(window).height(); }
      var getValue = function() { return $(window).scrollTop(); }   
      // Check if the browser supports the progress element.
      if ('max' in document.createElement('progress')) {
        // Set the 'max' attribute for the first time.
        progressBar.attr({ max: getMax() });
        progressBar.attr({ value: getValue() });
    
        $(document).on('scroll', function() {
          // On scroll only the 'value' attribute needs to be calculated.
          progressBar.attr({ value: getValue() });
        });

        $(window).resize(function() {
          var navbarHeight = $('#navbar').outerHeight(true);
          $('body').css({ 'padding-top': navbarHeight });
          $('progress-container').css({ 'padding-top': navbarHeight });
          progressBar.css({ 'top': navbarHeight });
          // On resize, both the 'max' and 'value' attributes need to be calculated.
          progressBar.attr({ max: getMax(), value: getValue() });
        });
      } else {
        var max = getMax(), value, width;
        var getWidth = function() {
          // Calculate the window width as a percentage.
          value = getValue();
          width = (value/max) * 100;
          width = width + '%';
          return width;
        }
        var setWidth = function() { progressBar.css({ width: getWidth() }); };
        setWidth();
        $(document).on('scroll', setWidth);
        $(window).on('resize', function() {
          // Need to reset the 'max' attribute.
          max = getMax();
          setWidth();
        });
      }
    });
  </script>

  <!-- Code Syntax Highlighting -->
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
  <script src="/assets/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Script Used for Randomizing the Projects Order -->
  <!-- <script type="text/javascript">
    $.fn.shuffleChildren = function() {
      $.each(this.get(), function(index, el) {
        var $el = $(el);
        var $find = $el.children();

        $find.sort(function() {
          return 0.5 - Math.random();
        });

        $el.empty();
        $find.appendTo($el);
      });
    };
    $("#projects").shuffleChildren();
  </script> -->

  <!-- Project Cards Layout -->
  <script type="text/javascript">
    var $grid = $('#projects');

    // $grid.masonry({ percentPosition: true });
    // $grid.masonry('layout');

    // Trigger after images load.
    $grid.imagesLoaded().progress(function() {
      $grid.masonry({ percentPosition: true });
      $grid.masonry('layout');
    });
  </script>

  <!-- Enable Tooltips -->
  <script type="text/javascript">
    $(function () {
      $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
